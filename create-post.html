<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Create Post | SEO Generator</title>
  <style>
    body { font-family: -apple-system, sans-serif; background: #eef7fb; margin: 0; padding: 0; }
    .app { padding: 20px; max-width: 600px; margin: 0 auto; }
    .header { display: flex; align-items: center; justify-content: space-between; padding: 14px 20px; background: #e8f5fb; border-bottom: 2px solid #9fd3ea; position: sticky; top: 0; z-index: 100; }
    .header a { text-decoration: none; font-size: 20px; color: #333; }
    .header .title { font-weight: 700; font-size: 18px; }
    .card { background: #e8f5fb; border: 2px solid #9fd3ea; border-radius: 16px; padding: 16px; margin-bottom: 16px; }
    .section-title { font-size: 20px; font-weight: 700; margin-bottom: 8px; }
    textarea, input { width: 100%; padding: 12px; border-radius: 10px; border: 2px solid #9fd3ea; font-size: 16px; box-sizing: border-box; margin-bottom: 8px; background: white; }
    textarea { min-height: 90px; resize: vertical; }
    .btn { width: 100%; display: flex; align-items: center; justify-content: center; padding: 14px 16px; border-radius: 12px; border: 0; cursor: pointer; font-size: 16px; font-weight: 700; background: #2fa84f; color: white; transition: 0.1s; }
    .btn.secondary { background: #1b74e4; margin-top: 10px; }
    .btn.loading { opacity: 0.7; cursor: progress; pointer-events: none; }
  </style>
</head>
<body>

  <div class="header">
    <a href="index.html">‚Üê</a>
    <div class="title">Create Post</div>
    <div style="width: 24px;"></div>
  </div>

  <div class="app">
    <div class="card">
      <div class="section-title">Describe your content</div>
      <textarea id="videoPrompt" placeholder="What is this video about? Who is it for?"></textarea>
      <button class="btn" id="generateBtn">‚ú® Generate SEO</button>
    </div>

    <div class="card">
      <div class="section-title">YouTube</div>
      <input id="ytTitle" placeholder="YouTube title" />
      <textarea id="ytDescription" placeholder="YouTube description"></textarea>
      <input id="ytHashtags" placeholder="Keywords" />
      <button class="btn secondary" id="ytUploadBtn">üöÄ Copy & Go to YouTube</button>
    </div>

    <div class="card">
      <div class="section-title">TikTok & Others</div>
      <textarea id="ttCaption" placeholder="TikTok/Social Caption"></textarea>
    </div>
  </div>

<script>
  // 1. UPDATE THIS TO YOUR ACTUAL WORKER URL
  const apiBase = "https://multipost-seo-worker.alexbryant.workers.dev";

  const generateBtn = document.getElementById("generateBtn");
  const videoPrompt = document.getElementById("videoPrompt");
  const ytTitle = document.getElementById("ytTitle");
  const ytDescription = document.getElementById("ytDescription");
  const ytHashtags = document.getElementById("ytHashtags");
  const ttCaption = document.getElementById("ttCaption");
  const ytUploadBtn = document.getElementById("ytUploadBtn");

  async function generateSEO() {
    const prompt = videoPrompt.value.trim();
    if (!prompt) return alert("Describe your video first!");

    generateBtn.classList.add("loading");
    generateBtn.innerText = "AI is thinking...";

    try {
      // PATH FIX: Changed to /api/generate-seo to match your Worker code
      const res = await fetch(apiBase + "/api/generate-seo", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt: prompt })
      });

      const json = await res.json();
      if (!json.success) throw new Error(json.error || "Generation failed");

      // DATA MAPPING FIX: Matches the AI logic in your app.js
      const d = json.data;
      ytTitle.value = d.youtube?.title || "";
      ytDescription.value = d.youtube?.description || "";
      ytHashtags.value = d.youtube?.keywords || "";
      ttCaption.value = d.tiktok?.allInOne || "";

    } catch (err) {
      alert("Error: " + err.message);
    } finally {
      generateBtn.classList.remove("loading");
      generateBtn.innerText = "‚ú® Generate SEO";
    }
  }

  ytUploadBtn.addEventListener("click", () => {
    const copyText = `TITLE: ${ytTitle.value}\n\nDESC: ${ytDescription.value}\n\nTAGS: ${ytHashtags.value}`;
    navigator.clipboard.writeText(copyText).then(() => {
      alert("Copied! Opening YouTube...");
      window.open("https://www.youtube.com/upload", "_blank");
    });
  });

  generateBtn.addEventListener("click", generateSEO);
</script>
</body>
</html>
