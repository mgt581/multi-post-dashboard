<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Folder View</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app">
    <header class="header"><a href="index.html">←</a> <span class="title" id="title">Folder</span></header>
    <div class="card" style="margin:20px;"><strong id="name">Name</strong><br><span id="count">0 accounts</span></div>
    <section class="cards" id="accountList"></section>
    <div class="card" style="display:flex; gap:10px; margin:20px;">
      <select id="platformSelect" style="flex:1;"><option value="tiktok">TikTok</option><option value="youtube">YouTube</option><option value="facebook">Facebook</option></select>
      <button onclick="addAccount()">Add</button>
    </div>
    <button class="card" style="width:90%; margin: 0 auto; display:block; background:#2fa84f; color:white;" onclick="location.href='create-post.html'">✏️ Create Post</button>
  </div>
  <script>
    const apiBase = "https://multipost-seo-worker.alexbryant.workers.dev/api";
    const fId = localStorage.getItem("activeFolderId");
    document.getElementById("title").innerText = localStorage.getItem("activeFolderName");
    document.getElementById("name").innerText = localStorage.getItem("activeFolderName");

    async function render() {
      const res = await fetch(`${apiBase}/get-accounts?folder_id=${fId}`);
      const accs = await res.json();
      document.getElementById("count").innerText = `${accs.length} accounts`;
      document.getElementById("accountList").innerHTML = accs.map(a => `
        <div class="card"><div class="icon">${a.platform[0]}</div><div class="card-text"><strong>${a.nickname}</strong><span>${a.platform}</span></div></div>
      `).join('');
    }

    async function addAccount() {
      const platform = document.getElementById("platformSelect").value;
      const nickname = prompt("Nickname:");
      await fetch(`${apiBase}/add-account`, { method: "POST", body: JSON.stringify({ folder_id: fId, platform, nickname }) });
      render();
    }
    window.onload = render;
  </script>
</body>
</html>
