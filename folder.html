<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Folder</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

<div class="app">

  <!-- HEADER -->
  <header class="header">
    <a href="posting.html" class="gear">←</a>
    <span class="title" id="folderTitle">Folder</span>
    <span></span>
  </header>

  <!-- FOLDER SUMMARY -->
  <section class="cards">
    <div class="card">
      <div class="card-text">
        <strong id="folderName">Loading…</strong>
        <span id="accountCount">0 connected accounts</span>
      </div>
    </div>
  </section>

  <!-- ACCOUNTS LIST -->
  <section class="cards" id="accountList"></section>

  <!-- ADD ACCOUNT BUTTON -->
  <section class="cards">
    <div class="card green" onclick="showPlatformPicker()">
      <div class="icon green">+</div>
      <div class="card-text">
        <strong>Add Account</strong>
        <span>Facebook, TikTok, Instagram, YouTube</span>
      </div>
      <div class="arrow">›</div>
    </div>
  </section>

</div>

<!-- PLATFORM PICKER MODAL -->
<div id="platformModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.4);">
  <div style="background:#fff; margin:20% auto; padding:20px; max-width:320px; border-radius:14px;">
    <strong>Select platform</strong>
    <div style="margin-top:10px;">
      <button onclick="addAccount('facebook')">Facebook</button><br><br>
      <button onclick="addAccount('tiktok')">TikTok</button><br><br>
      <button onclick="addAccount('instagram')">Instagram</button><br><br>
      <button onclick="addAccount('youtube')">YouTube</button><br><br>
      <button onclick="closeModal()">Cancel</button>
    </div>
  </div>
</div>

<script>
  // -----------------------------
  // LOAD DATA
  // -----------------------------
  let folders = JSON.parse(localStorage.getItem("folders")) || [];
  let activeFolderIndex = localStorage.getItem("activeFolder");
  let folder = folders[activeFolderIndex];

  const folderNameEl = document.getElementById("folderName");
  const folderTitleEl = document.getElementById("folderTitle");
  const accountCountEl = document.getElementById("accountCount");
  const accountListEl = document.getElementById("accountList");
  const modal = document.getElementById("platformModal");

  if (!folder) {
    folderNameEl.textContent = "Folder not found";
  } else {
    folderNameEl.textContent = folder.name;
    folderTitleEl.textContent = folder.name;
    renderAccounts();
  }

  // -----------------------------
  // RENDER ACCOUNTS
  // -----------------------------
  function renderAccounts() {
    accountListEl.innerHTML = "";
    accountCountEl.textContent = `${folder.accounts.length} connected accounts`;

    if (folder.accounts.length === 0) {
      accountListEl.innerHTML = `
        <div class="card">
          <div class="card-text">
            <strong>No accounts yet</strong>
            <span>Add a platform account to get started</span>
          </div>
        </div>
      `;
      return;
    }

    folder.accounts.forEach(acc => {
      const div = document.createElement("div");
      div.className = "card";
      div.innerHTML = `
        <div class="icon ${acc.platform}">${acc.platform[0].toUpperCase()}</div>
        <div class="card-text">
          <strong>${acc.name}</strong>
          <span>${acc.platform} account</span>
        </div>
      `;
      accountListEl.appendChild(div);
    });
  }

  // -----------------------------
  // ADD ACCOUNT FLOW
  // -----------------------------
  function showPlatformPicker() {
    modal.style.display = "block";
  }

  function closeModal() {
    modal.style.display = "none";
  }

  function addAccount(platform) {
    folder.accounts.push({
      platform: platform,
      name: `Connected ${platform} account`,
      addedAt: Date.now()
    });

    localStorage.setItem("folders", JSON.stringify(folders));
    closeModal();
    renderAccounts();
  }
</script>

</body>
</html>